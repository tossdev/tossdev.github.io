<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Tosspay Getting Started</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="https://static.toss.im/tds/favicon/favicon.ico" />
    <link rel="icon" type="image/png" sizes="16x16" href="https://static.toss.im/tds/favicon/favicon-16x16.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="https://static.toss.im/tds/favicon/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="48x48" href="https://static.toss.im/tds/favicon/favicon-48x48.png" />
    <link rel="icon" type="image/png" sizes="196x196" href="https://static.toss.im/tds/favicon/favicon-196x196.png" />
    <link rel="apple-touch-icon" sizes="57x57" href="https://static.toss.im/tds/favicon/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="https://static.toss.im/tds/favicon/apple-touch-icon-72x72.png" />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="https://static.toss.im/tds/favicon/apple-touch-icon-114x114.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="https://static.toss.im/tds/favicon/apple-touch-icon-120x120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="144x144"
      href="https://static.toss.im/tds/favicon/apple-touch-icon-144x144.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="https://static.toss.im/tds/favicon/apple-touch-icon-152x152.png"
    />
    <meta name="msapplication-TileImage" content="https://static.toss.im/tds/favicon/mstile-144x144.png" />

    <!-- stylesheets -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"
      integrity="sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ=="
      crossorigin="anonymous"
    />
    <link rel="stylesheet" type="text/css" href="https://static.toss.im/tds/current/css/tds.min.css" />
    <link rel="stylesheet" type="text/css" href="../css/prism.css" />
    <link rel="stylesheet" type="text/css" href="../css/tossdev.css" />

    <!-- javascript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"
      integrity="sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ=="
      crossorigin="anonymous"
    ></script>
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>

  <body id="gettingstarted" data-spy="scroll" data-target="#guide" data-offset="50" oncontextmenu="return false" ondragstart="return false" >
    <!-- Google Tag Manager -->
    <noscript>
      <iframe
        src="//www.googletagmanager.com/ns.html?id=GTM-TPTMLG"
        height="0"
        width="0"
        style="display:none;visibility:hidden"
      ></iframe>
    </noscript>
    <script>
      (function(w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
          'gtm.start': new Date().getTime(),
          event: 'gtm.js'
        });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != 'dataLayer' ? '&l=' + l : '';
        j.async = true;
        j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, 'script', 'dataLayer', 'GTM-TPTMLG');


    </script>
    <!-- End Google Tag Manager -->
    <!--
    <header id="tossdev-header">
        <div class="container">
            <div class="row">
                <a href="index.html"><img class="logo" src="https://static.toss.im/tds/icon/svg/logo-only-icon.svg" alt="toss developers logo"></a>
            </div>
        </div>
    </header>
-->

    <div class="sidebar">
      <div class="logo">
        <a href="index.html">
          <img class="logo-img" src="https://static.toss.im/tds/icon/svg/logo-only-icon.svg" alt="" />
          <span>Tosspay Guide</span>
        </a>
      </div>
      <div id="guide">
        <h1>
          <a href="#">Getting Started</a>
        </h1>
        <ul class="menu nav">
          <li>
            <a href="#payflow">Toss Pay Integration is Simple</a>
          </li>
          <li>
            <a href="#overview">From Application to Payment Completion</a>
            <ul class="nav">
              <li><a href="#overview-1">1. Apply for Toss Merchant Account</a></li>
              <li><a href="#overview-2">2. Request Toss Pay Generation</a></li>
              <li><a href="#overview-3">3. Recieve User Authentication</a></li>
              <li><a href="#overview-4">4. Complete User Authentication</a></li>
            </ul>
          </li>
          <li>
            <a href="#create">Generate Payment</a>
            <ul class="nav">
              <li><a href="#create-1">API Endpoint</a></li>
              <li><a href="#create-2">Mandatory Parameters</a></li>
              <li><a href="#create-3">Toss App Guideline</a></li>
              <li><a href="#create-6">Payment Expiration Time</a></li>
              <li><a href="#create-8">Issuing Cash Receipt</a></li>
              <li><a href="#create-9">Auto Approval</a></li>
              <li><a href="#create-11">Compound Tax</a></li>
            </ul>
          </li>
          <!-- 큰 의미가 없어 삭제처리함
          <li>
            <a href="#cancel">결제 취소하기</a>
            <ul class="nav">
              <li><a href="#cancel-1">API Endpoint</a></li>
              <li><a href="#cancel-2">필수 Parameters</a></li>
              <li><a href="#cancel-3">취소 사유 남기기</a></li>
              <li><a href="#cancel-4">구매자의 결제 취소 대응</a></li>
            </ul>
          </li>
          -->
          <li>
            <a href="#execute">Approval</a>
            <ul class="nav">
              <li><a href="#execute-1">API Endpoint</a></li>
              <li><a href="#execute-2">Mandatory Parameters</a></li>
            </ul>
          </li>
          <li>
            <a href="#refund">Refund</a>
            <ul class="nav">
              <li><a href="#refund-1">API Endpoint</a></li>
              <li><a href="#refund-2">Mandatory Parameters</a></li>
              <li><a href="#refund-3">Refund amount</a></li>
              <li><a href="#refund-4">Compound tax refund</a></li>
              <li><a href="#refund-5">Leaving refund reason</a></li>
            </ul>
          </li>
          <li>
            <a href="#checkstatus">Payment Status</a>
            <ul class="nav">
              <li><a href="#checkstatus-1">API Endpoint</a></li>
              <li><a href="#checkstatus-2">Mandatory Parameters</a></li>
              <li><a href="#checkstatus-3">Response for payment status reqeust</a></li>
              <li><a href="#checkstatus-4">Payment status list</a></li>
            </ul>
          </li>
          <li>
            <a href="#salesCheckLinkUrl">Credit Card Sales Slip</a>
          </li>
          <!-- 
          <li>
            <a href="#tradeStatementUrl">거래명세서</a>
          </li>
          -->
          <li>
            <a href="api.html" target="_blank"
              >API Docs<i class="fa fa-external-link" style="margin-left:4px;"></i
            ></a>
          </li>
        </ul>
      </div>
    </div>

    <div id="contents">
      <div id="methods">
        <div class="method" id="payflow">
          <div class="method-description">
            <br />
            <h3>Toss Pay Integration is Simple</h3>
            <p>
              The integration of Tosspay is as simple as its payment. Please refer to the diagram below for a better understanding before starting integration.
              <img src="../images/eng_whole_pay_flow.png" alt="결제 연동 흐름" />
            </p>
          </div>
        </div>
        <div class="method" id="overview">
          <div class="method-description">
            <h3>From Application to Payment Completion</h3>
            <h4 id="overview-1">1. Apply for Toss Merchant Account</h4>
            <p>
              First, apply for a merchant through <a href="https://product.toss.im/pay/merchant/apply.html" target="_blank">Inquire Contract</a>. Once the application approval is completed, the merchant account is issued, and you can log into Toss merchant manager page to manage the store. 
            </p>
            <p>
              If you log into Toss merchant manager page, you can check the <strong>API Keys</strong> of the payment store (The API Key issued may be found in ‘Merchant Manager > Merchant Information’). 
            </p>
            <p>The issued store API Key is used as an authentication in every transaction such as payment generation/refund, etc.</p>
            <div class="alert alert-warning" role="alert">
              <i
                class="fa fa-exclamation-triangle pull-left"
                aria-hidden="true"
                style="margin-top:8px;margin-left:6px"
              ></i>
              <p style="margin-left:10px">
                If API Key is leaked to the outside, unwanted payment generation or refund may take place, resulting in financial losses for the store.
                <br> Please be cautious not to expose the API key on the website or to third parties outside.
              </p>
            </div>
            <p>There are two types of API Keys that are issued (for testing/ for actual transaction). These two Keys are different as the following.</p>
            <ul>
              <li>
                <strong>Key for Testing</strong> : If you use this Key, the whole process is run the same as the actual payment process, except for the actual payment amount ‘withdrawal’ from the bank account. It is useful in the work of development since you can use it any time for testing without worrying about withdrawing the actual money.
              </li>
              <li>
                <strong>Key for Actual Transaction</strong> : The payment that actually ‘withdraw’ money can be processed only by using this key. This must be used for processing any payment with a customer who visits the store.
              </li>
              <br />
              <p>
                <strong><font color="#AA1212">Please be cautious.</font><br/>
                  Once testing is completed, please change it to ‘Key for Actual Transaction’ before resuming operation. <br /></strong>
                  Toss Pay provides the operating environment for all and depending on the apiKey, <br />it is classified into testing or actual transaction.<br>
                  <span class="bg-info">
                    If the service is released with the key for testing, there is the risk of the merchant not receiving the payment after providing the service to the customer for free although the customer makes payment successfully, so please check this carefully.
                </span>
              </p>
            </ul>
            <h4 id="overview-2">2. Request Toss Pay Generation</h4>
            <p>
              A customer takes a look at the ‘Toss Mall,’ selects a ‘Toss T-shirt’ worth 35,000 KRW, and requests payment. The Toss Mall should request ‘payment generation’ to the Toss payment server. Call the payment generation API as below.
            </p>
            <div class="well">
              Payment Generation API Endpoint
              <br />
              <strong>POST https://pay.toss.im/api/v2/payments</strong>
            </div>
            <p>The payment of the customer is requested as below.</p>
            <div class="method-example">
              <div class="languages">
                <a class="language selected" data-lang="language-bash" href="#">curl</a>
                <a class="language" data-lang="language-java" href="#">Java</a>
                <a class="language" data-lang="language-php" href="#">PHP</a>
              </div>
              <pre><code class="language-bash">curl https://pay.toss.im/api/v2/payments \
-H "Content-Type: application/json" \
-d '{
"orderNo":"1",
"amount":25000,
"amountTaxFree":0,
"productDesc":"Toss T-shirt",
"apiKey":"sk_test_w5lNQylNqa5lNQe013Nq",
"autoExecute":true,
"resultCallback":"https://YOUR-SITE.COM/callback",
"retUrl":"http://YOUR-SITE.COM/ORDER-CHECK",
"retCancelUrl":"http://YOUR-SITE.COM/close"
}'</code><code class="language-java">import java.nio.charset.StandardCharsets;

URL url = null;
URLConnection connection = null;
StringBuilder responseBody = new StringBuilder();
try {
url = new URL("https://pay.toss.im/api/v2/payments");
connection = url.openConnection();
connection.addRequestProperty("Content-Type", "application/json");
connection.setDoOutput(true);
connection.setDoInput(true);

org.json.simple.JSONObject jsonBody = new JSONObject();
jsonBody.put("orderNo", "1");
jsonBody.put("amount", 25000);
jsonBody.put("amountTaxFree", 0);
jsonBody.put("productDesc", "Toss T-shirt");
jsonBody.put("apiKey", "sk_test_w5lNQylNqa5lNQe013Nq");
jsonBody.put("autoExecute", true);
jsonBody.put("resultCallback", "https://YOUR-SITE.COM/callback");
jsonBody.put("retUrl", "http://YOUR-SITE.COM/ORDER-CHECK");
jsonBody.put("retCancelUrl", "http://YOUR-SITE.COM/close");

BufferedOutputStream bos = new BufferedOutputStream(connection.getOutputStream());
bos.write(jsonBody.toJSONString().getBytes(StandardCharsets.UTF_8));
bos.flush();
bos.close();

BufferedReader br = new BufferedReader(new InputStreamReader(connection.getInputStream(), StandardCharsets.UTF_8));
String line = null;
while ((line = br.readLine()) != null) {
responseBody.append(line);
}
br.close();
} catch (Exception e) {
responseBody.append(e);
}
System.out.println(responseBody.toString());</code><code class="language-php">$arrayBody = array();
$arrayBody["orderNo"] = "1";
$arrayBody["amount"] = 10000;
$arrayBody["amountTaxFree"] = 0;
$arrayBody["productDesc"] = "Toss T-shirt";
$arrayBody["apiKey"] = "sk_test_w5lNQylNqa5lNQe013Nq";
$arrayBody["autoExecute"] = true;
$arrayBody["resultCallback"] = "https://YOUR-SITE.COM/callback";
$arrayBody["retUrl"] = "http://YOUR-SITE.COM/ORDER-CHECK";
$arrayBody["retCancelUrl"] = "http://YOUR-SITE.COM/close";
$jsonBody = json_encode($arrayBody);

$ch = curl_init('https://pay.toss.im/api/v2/payments');
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "POST");
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_POSTFIELDS, $jsonBody);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, array(
'Content-Type: application/json',
'Content-Length: ' . strlen($jsonBody))
);

$result = curl_exec($ch);
curl_close($ch);

echo "Response: ".$result;</code></pre>
            </div>
            <p>As you can see in the above example, 9 setting values should be included and requested to Toss for ‘payment generation.’ </p>
            <ol>
              <li><strong>orderNo (store order number)</strong> : necessary for matching the store order information and payment information</li>
              <li><strong>amount (payment amount)</strong> : total payment amount to be received from the customer</li>
              <li><strong>amountTaxFree (nontaxable amount)</strong> : nontaxable amount to be received from the customer out of all the amounts to be received</li>
              <li><strong>productDesc (product name)</strong> : information on the product to be paid</li>
              <li>
                <strong>apiKey (store API Key)</strong> : If you input the ‘Key for Testing’ here, a test payment is generated, and if you enter the ‘Key for Actual Transaction,’ a payment that actually withdraws money will be generated.
              </li>
              <li>
                <strong>autoExecute (automatic authorization setting)</strong> : If ‘true’ is adopted, Toss will process authorization after purchaser authentication is completed.
              </li>
              <li>
                <strong>resultCallback (payment result Callback URL)</strong> : If the authorization setting is set as ‘true,’ it must be sent along. <br />
                The Toss server requests callback to the merchant server inserted here after the withdrawal is successfully completed. In the end, Toss payment completion may be seen. 
              </li>
              <li>
                <strong>retUrl (URL to connect to after completion of authentication)</strong> : After completing payment authentication, the purchaser is directed to the URL entered here. This URL is used only for the transfer to the payment completion page of the merchant.
              </li>
              <li>
                <strong>retCancelUrl (merchant page to which user is directed to once payment is suspended)</strong> : Please enter the URL of the merchant cancelation page to which the user will be transferred if the user who enters the Toss Pay screen suspends payment.
              </li>
            </ol>
            <div class="alert alert-warning" role="alert">
              <i
                class="fa fa-exclamation-triangle pull-left"
                aria-hidden="true"
                style="margin-top:8px;margin-left:6px"
              ></i>
              <p style="margin-left:10px">
                As mentioned above, API Key should never be leaked.<br />
                Please be careful not to expose the content of payment requests on the web page.
              </p>
            </div><br>
            <p>If the requested payment generation is completed, Toss will reply as the following.<br>
              If any of these values is not delivered, please check '<a href="qna.html#faq-1">'Toss Firewall Setting</a>' since it may be the issue of firewall.  </p>
            <div class="method-example">
              <pre><code class="always-visible language-bash">{"code":0,"checkoutPage":"https://pay.toss.im/payfront/auth?payToken=test_token1234567890",
"payToken":"example-payToken"}</code></pre>
            </div>
            <p><span class="bg-info">code '0'</span> means payment is ‘successfully’ generated. Otherwise, error codes and messages are delivered.</p>
            <p>
              <span class="bg-info">checkoutPage</span> is the Toss Pay web page URL for processing payment. Please make sure this URL is displayed to the users in the store.
            </p>
            <p>
              <span class="bg-info">payToken</span> is the eigenvalue of Toss that distinguishes transactions. Please manage the token cautiously since the transaction will be accessed through this unique value when processing payment and refund as well as identifying the status of the payment. 
            </p>

            <h4 id="overview-3">3. Receive User Authentication</h4>
            <p>
              The process of Toss Pay is simple. You simply need to send the purchaser through <span class="bg-info">'checkoutPage'</span> URL received in response at the moment payment is generated.
            </p>
            <p>checkoutPage of the example above is the following (a different URL is issued for each payment).</p>
            <div class="method-example">
              <pre
                class=" language-http"
              ><code class="always-visible  language-http">https://pay.toss.im/payfront/auth?payToken=example-payToken</code></pre>
            </div>
            <p><strong>Please pay attention to the following for transferring to checkoutPage URL.</strong></p>
            <ul>
              <li><strong>Do not open checkoutPage with iframe.</li></strong> If one or several layer(s) of iframe is opened and checkoutPage is loaded inside, it will not be redirected to retUrl after purchaser authentication is completed in Toss App, preventing payment authorization.
              <li>
                <strong>If checkoutPage is opened in the in-app browser (WebView) of Android app, please make sure <a href="https://developer.android.com/reference/android/webkit/WebViewClient#shouldOverrideUrlLoading(android.webkit.WebView,%20android.webkit.WebResourceRequest)">shouldOverrideUrlLoading</a> method is implemented and it is redirected to retUrl.</strong> If this method returns ‘true’ for all cases, payment is not authorized as it is not redirected in WebView. Please refer to the following documents.
                <ul>
                  <li><a href="https://developer.android.com/reference/android/webkit/WebViewClient#shouldOverrideUrlLoading(android.webkit.WebView,%20android.webkit.WebResourceRequest)">shouldOverrideUrlLoading document</a></li>
                  <li><a href="https://medium.com/nerd-for-tech/androids-webview-common-challenges-and-it-s-solution-part-1-9b970b95a482">https://medium.com/nerd-for-tech/androids-webview-common-challenges-and-it-s-solution-part-1-9b970b95a482</a></li>
                </ul>
              </li>
            </ul>
            <p>
              <br />
              The purchaser may proceed with payment after selecting the payment method through the Toss screen that is called.
            </p>
            <p>
              From then on, Toss oversees the whole process up to payment authentication (if Toss Money is selected, top-up takes place after verifying account validity; for card payment, the cardholder’s identity is checked and then the card may be added).<br />
              This is the section in which the communication between Toss App and Toss server takes place.
              <br /><br />
            </p>
            <p>
              If the customer is connected to the adequate URL, payment will proceed through the screen below.
              <img src="../images/flow_pay.png" alt="결제 진행 흐름" />
            </p>
            <div class="well">
              1. <strong>Member of Toss</strong> : after selecting the payment method and entering the Toss password, the payment is completed <br />
              2. <strong>Non-member of Toss</strong> : payment is proceeded after installing and subscribing to Toss App
              <br />
            </div>
            <div class="alert alert-warning" role="alert">
              <i
                class="fa fa-exclamation-triangle pull-left"
                aria-hidden="true"
                style="margin-top:8px;margin-left:6px"
              ></i>
              <p style="margin-left:10px">
                <strong>Toss supports the app payment method. </strong><br>
                For payments made in PC web browser, the payment push notification is sent to the user’s mobile phone. <br>
                Any follow-up authentication should be processed through Toss App. For security purpose, the web payment in the form of web keyboard is not provided.
              </p>
            </div>

            <h4 id="overview-4">4. Complete User Authentication</h4>
            <p>
              As in the diagram below, if the customer enters the payment password properly, purchaser authentication is completed. Then, Toss sends the customer to <span class="bg-info">'retUrl'</span> that is transferred when payment is generated. 
              <img src="../images/flow_pay_complete.png" alt="결제 완료 처리" />
            </p>

            <p>
              When sending the customer to retUrl, order number (orderNo) and payment method (payMethod) are sent along with the authentication result (status) via query string parameter. The example is as follows. <br>
              For card payments, the payment card code (cardCompany) is returned to the authentication data below additionally, and for Toss Money payments, bank codes (bankCode) are returned.
            </p>
            <div class="method-example">
              <pre
                class=" language-http"
              ><code class="always-visible  language-http">http://YOUR-SITE.COM/ORDER-CHECK?status=PAY_COMPLETE&orderNo=1&payMethod=TOSS_MONEY&bankCode=38</code></pre>
            </div>
            <p>Please check the status value here.</p>
            <ul>
              <li><strong>For automatic authorization (“autoExecute”:true) : ?status=PAY_COMPLETE</li></strong>
              <li><strong>For automatic authorization (“autoExecute”:false) : ?status=PAY_APPROVED</li></strong>
            </ul>
            <div class="method" id="create">
              <div class="method-description">
                <h3>Generate Payment</h3>
                <p>
                  Let’s take a look at the payment generation request in detail. The example below shows the code that used all the parameters supported by the payment generation API
                </p>
                <div class="method-example">
                  <div class="languages">
                    <a class="language selected" data-lang="language-bash" href="#">curl</a>
                  </div>
                  <pre><code class="language-bash">curl https://pay.toss.im/api/v2/payments \
-H "Content-Type: application/json" \
-d '{
"orderNo":"1",                                           # unique order number of Toss Mall (mandatory)
"amount":25000,                                          # payment amount (mandatory)
"amountTaxFree":0,                                       # nontaxable amount (mandatory)
"productDesc":"Toss T-shirt",                            # product information (mandatory)
"apiKey":"sk_test_w5lNQylNqa5lNQe013Nq",                 # store API Key (mandatory)
"retUrl":"http://YOUR-SITE.COM/ORDER-CHECK?orderno=1",   # web URL to connect to after payment is completed (mandatory)
"retCancelUrl":"http://YOUR-SITE.COM/close",             # web URL to connect to when payment is canceled (mandatory)
"autoExecute":true,                                      # automatic authorization setting (mandatory)
"resultCallback":"https://YOUR-SITE.COM/callback",       # payment result callback web URL (mandatory – if automatic authorization setting is true)
"callbackVersion":"V2",                                  # callback version (mandatory – if automatic authorization setting is true)
"amountTaxable":22727,                                   # payment amount out of taxable amount
"amountVat":2273,                                        # VAT out of payment amount
"amountServiceFee":0,                                    # service fee out of payment amount
"expiredTime":"2019-06-17 12:47:35",                     # scheduled time of payment expiration
"cashReceipt":true,                                      # cash receipt issuance availability
}'</code></pre>
                </div>
                <h4 id="create-1">Endpoint of Payment Generation API</h4>
                <div class="well">POST https://pay.toss.im/api/v2/payments</div>
                <h4 id="create-2">Mandatory Parameters</h4>
                <p>Please send the following 9 values for requesting payment generation.</p>
                <ol>
                  <li><strong>Store order number</strong> : necessary for matching the store order information with the payment information</li>
                  <li><strong>Payment amount</strong> : the amount to be received from customers</li>
                  <li><strong>Nontaxable amount</strong> : the nontaxable amount out of the amount to be received from customers</li>
                  <li><strong>Product name</strong> : the information of the product to be paid</li>
                  <li>
                    <strong>Store API key</strong> : if the ‘Key for Testing’ is inserted here, a test payment is generated, and if the ‘Key for Actual Transaction’ is inserted, a payment with actual withdrawal is generated
                  </li>
                  <li>
                    <strong>URL to connect to after completing purchaser authentication</strong> : If a purchaser confirms payment and completes authentication, the purchaser is sent to the URL set via this parameter. Generally, the purchase completion page or the place to connect to the page is designated.
                  </li>
                  <li>
                    <strong>URL to connect to when the purchaser cancels payment</strong> : If a purchaser cancels the payment, the purchaser is sent to the URL set via this parameter, and Toss cancels the transaction automatically. If the store needs to distinguish canceled transactions, please distinguish them independently.
                  </li>
                  <li>
                    <strong>Automatic authorization setting</strong> : If the purchaser completes authentication, Toss automatically processes authorization. The merchant only needs to check the result value.
                  </li>
                  <li>
                    <strong>Payment result callback URL</strong> : If the Toss server successfully completes the withdrawal, a payment success callback is requested to the merchant’s server. Then, the merchant may process the logic such as changing the status of payment completion (this is a mandatory value only if the automatic authorization is set as ‘true’).
                  </li>
                </ol>
                <!--
                    <h4 id="create-4">결제 결과 callback URL (resultCallback)</h4>
                    <p>결제 생성이 성공적으로 끝나면, 해당 결제건은 '결제 대기' 상태가 됩니다. 이후, 결제는 '완료'되거나 '취소'되거나 혹은 '환불'처리됩니다.</p>
                    <p>그러한 상태 변경이 있을 때 마다 상점의 주문 상태를 변경하거나 구매자에게 안내를 해주어야 한다면 '결제 결과에 대한 callback' 파라미터를 사용하세요. 이 파라미터에 응답을 받을 URL을 등록하시면, 아래와 같이 callback을 보내드리겠습니다.</p>
                    <div class="method-example">
                        <pre><code class="always-visible language-bash">{
"payToken":"test_token1234567890",         # 상태가 바뀐 결제건의 고유 번호
"orderNo":"1",                              # 결제건과 연결된 상점 주문번호
"status":"PAY_COMPLETE"                     # 최종적으로 바뀐 결과
"metadata":"{'size':'XL','color':'Red'}"    # 결제 생성 시 저장한 metadata
}</code></pre>
                    </div>
                    <p>"status" 값은 결제 결과에 따라 다음과 같이 보내드립니다.</p>
                    <ul>
                        <li><strong>PAY_COMPLETE</strong> : 결제가 성공적으로 완료되었음</li>
                        <li><strong>PAY_CANCEL</strong> : 결제가 완료되기 전에 취소됨</li>
                        <li><strong>REFUND_SUCCESS</strong> : 완료된 결제가 환불 처리됨</li>
                    </ul>
-->


                <h4 id="create-3">Toss App Guideline</h4>
                <p>The specification supported by Toss for app payment is as follows. Please check the following.<br>
                <ul>
                  <li>For Android, use Intent URI </li>
                  <li>For iPhone (iOS), use Universal Link</li> <br>

                      <strong> Example for Android</strong> <br>
                      intent://pay?payToken={payToken}#Intent;scheme=supertoss;package=viva.republica.toss;end <br><br>

                      <strong>Example for iOS</strong><br>
                      https://ul.toss.im?scheme=supertoss%3A%2F%2Fpay%3FpayToken%3D{payToken}
                </ul>
                <br>
                      <p> ✓ This function is for calling Toss App or moving to App store right after checking whether Toss App is installed or not when clicking ‘Pay by App.’ 
                      <p> ✓ Since the link above is directly called from the Toss Pay server, please make sure that the link above is permitted in the merchant’s app. 
                      <p> ✓ For Android, Intent URI parsing of the merchant is necessary.
                      <p> ✓ Toss does not officially support iframe, but if Toss App is inevitably called by iframe, the app may not be called, or errors may occur, thus it is recommended to call it by opening a new screen.

                <h4 id="create-6">Payment Expiration Time (expiredTime)</h4>
                <p>
                  You can set ‘the time up to when payment authorization may be processed after a payment is generated’ through this parameter. If the ‘payment on standby’ reaches the expiration date, it is automatically canceled in the Toss server.
                </p>
                <p>Depending on the features of the product for sale or the store, you can set the expiration period as long or short.</p>
                <ul>
                  <li>
                    If there is little change in stocks, and if the payment of the purchaser is not urgent, set the payment expiration period as long. The purchaser may order first and then make payment at any time the purchaser prefers.
                  </li>
                  <li>
                    If there is a huge change in stocks or keeping ‘payment on standby’ long is not preferred, set the payment expiration period as short.
                  </li>
                </ul>
                <p>
                  <span class="bg-info"
                    >The payment expiration period is 60 minutes at the maximum, and without any particular setting, it is set as 15 minutes by default.</span
                  >
                </p>
                <h4 id="create-8">Availability of Cash Receipt Issuance (cashReceipt)</h4>
                <p>
                  It is feasible to set the availability of cash receipt issuance
                  <br />
                  Cash receipts cannot be issued for card payments or securities such as culture or department store gift cards, mobile coupons, etc. which are excluded from taxation, and only the payments made with cash equivalents such as Toss Money are subject to cash receipt issuance. 
                </p>
                <ul>
                  <li><strong>true</strong> : able to issue cash receipts (if the value is not set, ‘true’ is the default)</li>
                  <li><strong>false</strong> : unable to issue cash receipts</li>
                </ul>
                <h4 id="create-9">Automatic Authorization (autoExecute)</h4>
                <p>
                  Toss Pay provides two options.<br>
                  After purchaser authentication is completed, Toss immediately tries withdrawal, and depending on the method of completing payment and the stock, the merchant may become the subject of the ‘final authorization.’ Depending on the product sold at the payment store, two methods may be taken into account.
                </p>
                <br />
                <ol>
                  <li>
                    <strong>When payment is generated, setting autoExecute as ‘true’</strong> : after purchaser authentication is completed, payment completion status is delivered with withdrawal trial. 
                  </li><br>
                  <li>

                    <strong>When payment is generated, setting autoExecute as ‘false’</strong> : payment is on standby before the final authorization of the merchant (PAY_APPROVED status)<br>
                    <strong>Final authorization through payment authorization API</strong> (<a href="gettingstarted.html#execute">execute API</a>): When authorization is requested for the payment in the PAY_APPROVED status, the amount is withdrawn, and as the withdrawal is completed, the status is changed to ‘payment complete.’ At the same time, the balance for Toss Money is checked, and if the balance is low, the amount is withdrawn after topping up.
                  </li>
                </ol>
                <br />
                <p>
                  Refer to the following diagram. 
                  <img src="../images/eng_flow_autoExecute_modify.png" alt="결제 승인 흐름" />
                </p>
                <h4 id="create-11">Compound Taxation (amount-)</h4>
                <p>
                  If a certain amount to be processed as ‘nontaxable’ is included in the total payment amount, or if you would like to set the ratio differently for VAT and the service fee, use the ‘compound taxation’ parameter when payment is generated.
                </p>
                <ul>
                  <li><strong>amountTaxable</strong> : the ratio of the 'taxable amount' from the payment amount</li>
                  <li><strong>amountTaxFree</strong> : the ratio of the ‘nontaxable amount’ from the payment amount</li>
                  <li><strong>amountVat</strong> : the ratio of ‘VAT’ from the payment amount'</li>
                  <li><strong>amountServiceFee</strong> : the ratio of the ‘service fee’ from the payment amount</li>
                </ul>
                <p>
                  Toss checks only the total amount and the nontaxable amount mandatorily. If you need to select compound taxation, please set the 4 values, and the sum of those 4 values must be equal to the total payment amount. Otherwise, an error occurs.
                  <br />
                  The value set through the above parameter is reflected in the cash receipt as-is.
                </p>
                <p>
                  If the parameter value above is not set, it is processed automatically as the following.
                </p>
                <ul>
                  <li><strong>VAT</strong> : the total amount is divided by 11 and it is rounded up at the first decimal digit</li>
                  <li><strong>Taxable amount: </strong> : the remaining value after deducting VAT from the total amount</li>
                  <li><strong>Nontaxable amount, service fee</strong> : 0</li>
                </ul>
                <p>
                  However, for payments unavailable for issuing cash receipts (cashReceipt = false), it is processed as the following.
                </p>
                <ul>
                  <li><strong>Taxable amount: </strong> : equal to the total amount</li>
                  <li><strong>VAT, nontaxable amount, service fee</strong> : 0</li>
                </ul>
              </div>
            </div>


<!--
        <div class="method" id="cancel">
          <div class="method-description">
            <h3>결제 취소하기</h3>
            <p>
              결제가 아직 완료되지 않은 '대기' 상태에서 결제를 취소할 수 있습니다. 아래 예제는 결제 취소 API가 지원하는
              모든 파라미터를 사용한 코드입니다.
            </p>
            <div class="method-example">
              <div class="languages">
                <a class="language selected" data-lang="language-bash" href="#">curl</a>
              </div>
              <pre><code class="language-bash">curl "https://pay.toss.im/api/v1/cancel" \
-H "Content-Type: application/json" \
-d '{
"apiKey":"sk_test_w5lNQylNqa5lNQe013Nq", # 상점의 API Key (필수)
"payToken":"example-payToken",           # 결제 고유 번호 (필수)
"reason":"재고 부족"                       # 취소 사유
}'
</code></pre>
            </div>
            <h4 id="cancel-1">결제 취소 API의 Endpoint</h4>
            <div class="well">POST https://pay.toss.im/api/v1/cancel</div>
            <h4 id="cancel-2">필수 Parameters</h4>
            <p>필수 파라미터는 딱 2가지 입니다. '어느 가맹점'에서 '어떤 결제건'을 취소하는지만 알려주세요!</p>
            <ol>
              <li><strong>상점 API Key</strong> : 결제를 생성한 상점의 API key가 필요합니다.</li>
              <li><strong>결제 고유 토큰 (payToken)</strong> : 결제 생성 완료 후 받은 결제 고유번호</li>
            </ol>
            <h4 id="cancel-3">취소 사유 남기기 (reason)</h4>
            <p>
              결제 취소 사유를 기록해야한다면 이 파라미터를 활용하세요. <span class="bg-info">최대 255자까지</span> 남길
              수 있습니다.
            </p>
            <h4 id="cancel-4">구매자의 결제 취소 대응</h4>
            <p>
              구매자도 결제를 취소할 수 있습니다. 이에 대응하기 위해 결제 생성 시 retCancelUrl 을 등록하고, '취소'가
              발생한 경우 주문 상태 변경등의 적절한 처리를 해주세요. 
            </p>
          </div>
        </div>
-->


        <div class="method" id="execute">
          <div class="method-description">
            <h3>Approval</h3>
            <p>
              Payment may be processed after the stock is confirmed, in the ‘standby’ status in which purchaser authentication is completed. <br>
              The example below is the code that used some parameters supported by authorization API.</p>
            <div class="method-example">
              <div class="languages">
                <a class="language selected" data-lang="language-bash" href="#">curl</a>
              </div>
              <pre><code class="language-bash">curl "https://pay.toss.im/api/v2/execute" \
-H "Content-Type: application/json" \
-d '{
"apiKey":"sk_test_w5lNQylNqa5lNQe013Nq", # Store API Key (mandatory)
"payToken":"example-payToken",           # payment number (mandatory)
}'
</code></pre>
            </div>
            <h4 id="execute-1">Endpoint of Payment Approval API</h4>
            <div class="well">POST https://pay.toss.im/api/v2/execute</div>
            <h4 id="execute-2">Mandatory Parameters</h4>
            <p>
              There are 2 mandatory parameters of ‘payment authorization.’ Please notify ‘which payment’ is authorized at ‘which merchant.’
            </p>
            <ol>
              <li><strong>Store API Key</strong> : the API key of the store that generated payment is needed.</li>
              <li><strong>Payment token (payToken)</strong> : the unique payment number received after payment generation is completed.</li>
            </ol>
          </div>
        </div>

        <div class="method" id="refund">
          <div class="method-description">
            <h3>Refund</h3>
            <p>
              Returning a part of or the entire amount of the completed payment to the purchaser.<br />
              Immediately after the refund is completed, the requested amount is transferred to the account of the purchaser for the transaction paid with Toss Money, and authorization is canceled for the transaction paid with a credit card.
            </p>
            <p>The following example is the code used from the parameters supported by the payment refund API.</p>
            <div class="method-example">
              <div class="languages">
                <a class="language selected" data-lang="language-bash" href="#">curl</a>
              </div>
              <pre><code class="language-bash">curl "https://pay.toss.im/api/v2/refunds" \
-H "Content-Type: application/json" \
-d '{
"apiKey":"sk_test_w5lNQylNqa5lNQe013Nq", # store API key (mandatory)
"payToken":"example-payToken",           # payment number (mandatory)
"amount":10000,                          # amount to be refunded (mandatory)
"amountTaxable":5000,                    # taxable amount of the amount to be refunded
"amountTaxFree":4000,                    # non-taxable amount from the amount to be refunded(mandatory)
"amountVat":500,                         # VAT of the amount to be refunded
"amountServiceFee":500                   # service fee of the amount to be refunded
}'
</code></pre>
            </div>
            <h4 id="refund-1">Endpoint of payment refund API</h4>
            <div class="well">POST https://pay.toss.im/api/v2/refunds</div>
            <h4 id="refund-2">Mandatory parameters</h4>
            <p>
              There are four mandatory parameters of 'payment refund.' Please indicate ‘which transaction’ made at ‘which merchant’ needs a refund.
            </p>
            <ol>
              <li><strong>Store API Key</strong> : the API key of the store where the payment is made.</li>
              <li><strong>Payment Token (payToken)</strong> : the payment number received after payment generation is completed.</li>
              <li><strong>Amount to be refunded (amount)</strong> : the amount to be refunded. </li>
              <li><strong>Non-taxable refund amount (amountTaxFree)</strong> : the non-taxable amount of the amount to be refunded.</li>
            </ol>
            <h4 id="refund-3">Refund amount</h4>
            <p>
              For a partial refund of the total paid amount, set this parameter value. If you do not set the amount, the entire amount will be refunded.
            </p>
            <h4 id="refund-4">Compound tax refund</h4>
            <p>
              When the payment is generated, you must designate which amount you will request a refund for if you designated the specific composition of the amount (taxable amount/non-taxable amount/VAT/services fee). 
            </p>
            <p>
              The amount requested for a refund must be smaller than or equal to the ‘remaining payment amount’ and the sum of the specific amounts to be refunded must be equal to the entire refund amount (an error occurs if they do not match). 
            </p>
            <h4 id="refund-5">Leaving refund reason</h4>
            <p>
              Use this parameter if you need to leave the reason for a refund. You can write <span class="bg-info">up to 255</span> at the maximum. 
            </p>
          </div>
        </div>

        <div class="method" id="checkstatus">
          <div class="method-description">
            <h3>Payment Status</h3>
            <p>
              The payment ‘status’ changes continuously as payment is generated and processed. Operating a store will require frequently identifying the status of a specific transaction (whether payment is processed well or canceled, or whether any refund request has been completed). 
            </p>
            <p>
              In such case, search ‘payment status confirmation API.’ For some cases, you can use it even if you do not receive any authorization or refund response.<br>
              The following example is the code for calling payment status confirmation API.
            </p>
            <div class="method-example">
              <div class="languages">
                <a class="language selected" data-lang="language-bash" href="#">curl</a>
              </div>
              <pre><code class="language-bash">curl "https://pay.toss.im/api/v2/status" \
-H "Content-Type: application/json" \
-d '{
"apiKey":"sk_test_w5lNQylNqa5lNQe013Nq",   # store API Key (mandatory)
"payToken":"example-payToken",             # payment number (mandatory)
}'
</code></pre>
            </div>
            <h4 id="checkstatus-1">Endpoint of payment status confirmation</h4>
            <div class="well">POST https://pay.toss.im/api/v2/status</div>
            <h4 id="checkstatus-2">Mandatory parameters</h4>
            <p>There are 2 mandatory parameters. Please designate ‘which transaction’ you want to view from ‘which merchant.’</p>
            <ol>
              <li><strong>Store API Key</strong> : the API key of a store where payment is generated is needed</li>
              <li><strong>Payment Token (payToken)</strong> : the payment number received after payment is generated</li>
            </ol>
            <p>* You can use ‘store order number (orderNo)’ instead of 'payment token (payToken).'</p>
            <h4 id="checkstatus-3">Response for payment status </h4>
            <p>You will receive the following response for a payment status confirmation request. <br>
              This is a part of the response, and please refer to <a href="api.html#status">payment status API</a> for more details.</p>
            <div class="method-example">
              <pre><code class="always-visible language-bash">{
"code": 0,                            # response code
"payToken": "example-payToken",       # payment token
"orderNo": "1",                       # order number of store
"payStatus": "PAY_COMPLETE",          # payment status
"payMethod": "TOSS_MONEY",            # payment method
"amount": 15000,                      # payment request amount
"transactions": [                     # transaction list
 {
    "stepType": "PAY",
    "transactionId": "3243c76e-4669-881b-33a3b82ddf49",
    "transactionAmount": 15000,
    "discountAmount": 300,
    "pointAmount": 0,
    "paidAmount": 14700,
    "regTs": "2020-03-01 12:33:20"
  }
],
"createdTs": "2020-03-01 12:33:04",   # first payment request time
"paidTs": "2020-03-01 12:33:20"       # time for payment completion
}
</code></pre>
            </div>
            <p>Each item has the following meanings.</p>
            <ul>
              <li><strong>Response code</strong> : the result for requests. The result is ‘0’ if it is processed successfully.</li>
              <li>
                <strong>Unique payment token</strong> : the payment token received after payment is generated. If you view the status with the ‘order number,’ you can get the payment number with this value.
              </li>
              <li>
                <strong>Order number of store</strong> : the order number used at the store. If you view the status with ‘payToken,’ you can get the ‘order number’ with this value. 
              </li>
              <li>
                <strong>Payment method</strong> : you can check the payment method selected by the purchaser.
              </li>
              <li>
                <strong>Payment status</strong> : payment status at the time of viewing (refer to the ‘payment status list’ below)
              </li>
              <li>
                <strong>Transaction list</strong> : transaction list processed at the time of viewing (cancelation, refund, etc.)
              </li>
              <li>
                <strong>Initial payment request time</strong> : you can check the time the purchaser requested payment for the first time
              </li>
              <li>
                <strong>Payment processing time</strong> : you can check the time the request is completed.
              </li>
            </ul>
            <h4 id="checkstatus-4">Payment status list</h4>
            <p>
              The payment status shall be one of the following.
              <br />
              After a payment case is generated, the payment status is changed as payment is carried out, and for each payment status, the action that the seller or purchaser can request changes according to each payment status. 
              <br />Please check detail here <a href="api.html#state">payment API > payment status</a>.
            </p>
            <table class="table table-hover">
              <tr>
                <td width="50%">PAY_STANDBY</td>
                <td width="50%"><strong>Payment on standby</strong></br>
                <p>The status in which a payment case is generated, and the purchaser’s payment is on standby. In this status, the purchaser or the merchant can cancel the payment. If the ‘expiration period’ is reached, it is automatically canceled.</p> </td>
              </tr>
              <tr>
                <td>PAY_APPROVED</td>
                <td><strong>Purchaser authentication complete </strong></br>
                  <p>The status in which purchaser authentication for payment is completed and the final authorization of the merchant is on standby
                    (When payment is generated, this phase comes up only if ‘autoExecute’ is set as false. 
                    If the payment ‘valid period expires’ in this status, it is automatically canceled.)
                    </p></td>
              </tr>
              <tr>
                <td>PAY_CANCEL</td>
                <td><strong>Payment cancelation </strong></br>
                  <p>The contract of which the purchaser cancels payment before payment is completed or the valid period has expired (the case that is terminated without any transfer of the amount).</p></td>
              </tr>
              <tr>
                <td>PAY_PROGRESS</td>
                <td><strong>Payment in progress</strong></br>
                  <p>The status in which the purchaser authorized payment and the payment amount is withdrawn from the account of the purchaser.</p></td>
              </tr>
              <tr>
                <td>PAY_COMPLETE</td>
                <td><strong>Payment complete</strong></br>
                  <p>The status in which payment authorization and withdrawal of the purchaser or the merchant is completed properly.</p></td>
              </tr>
              <tr>
                <td>REFUND_PROGRESS</td>
                <td><strong>Refund in progress</strong></br>
                  <p>The entire or partial refund is in progress and other refunds cannot be carried out before it is completed.</p></td>
              </tr>
              <tr>
                <td>REFUND_SUCCESS</td>
                <td><strong>Successfully refunded </strong></br>
                  <p>The entire or partial refund is completed, and the refunded amount is deposited in the purchaser’s account.</p></td>
              </tr>
              <tr>
                <td>SETTLEMENT_COMPLETE</td>
                <td><strong>Settlement complete</strong></br>
                  <p>The paid amount is settled, and a refund is no longer available (a year has passed from the date of authorization or purchase confirmation).</p></td>
              </tr>
              <tr>
                <td>SETTLEMENT_REFUND_COMPLETE</td>
                <td><strong>Refund settlement complete </strong></br>
                  <p>The entire or partial refund is settled, and a refund is no longer available (a year has passed from the date of authorization or purchase confirmation, or the entire refund is settled)</p></td>
              </tr>
            </table>
          </div>
        </div>



        <div class="method" id="salesCheckLinkUrl">
          <div class="method-description">
            <h3>Credit card sales slip</h3>
            <p>
              Call the payment token of the transaction for the sales slip that needs to be checked.
            </p>
                <ul>
                  <li><strong>Payment token (payToken)</strong> : authorization case in which the transaction status needs to be checked</li>
                </ul>
                <br>
            <p>
              The call URL is as follows. Send the parameter for the call in the query string form.
            </p>
            <div class="method-example">
              <pre
                class=" language-http"
              ><code class="always-visible  language-http">https://pay.toss.im/payfront/web/external/sales-check?payToken=example-payToken&transactionId=12637496-8a46-488c-bc30-febded96656f</code></pre>
            </div>
            <br>
            <p> ✓ Only the credit card transaction can be checked. Check with cash receipt for payments made with Toss Money.
            <p> ✓ Checking the sales slip requires additional authentication with the purchaser’s ‘birthday’ and ‘mobile phone.’
            <p> ✓ Incomplete transactions such as payment on standby (PAY_APPROVED) or payment cancelation (PAY_CANCEL) cannot be checked.
            <p> ✓ As the transaction code value is not a mandatory value, use it as an option value if you want to check a certain status.
          </div>
        </div>
				<!-- 
				<div class="method" id="tradeStatementUrl">
          <div class="method-description">
            <h3>거래명세서</h3>
            <p>
              거래명세를 확인할 거래건의 결제토큰을 호출해 주세요.
            </p>
                <ul>
                  <li><strong>결제 토큰 (payToken)</strong> : 거래상태를 확인할 승인건의 결제토큰</li>
                </ul>
                <br>
            <p>
              호출 URL은 다음과 같습니다. 호출에 필요한 결제 토큰(payToken)을 URL에 포함시켜 보내주시면 됩니다.
            </p>
            <div class="method-example">
              <pre
                class=" language-http"
              ><code class="always-visible  language-http">https://merchant.pay.toss.im/external/pays/{example-payToken}/authentication</code></pre>
            </div>
            <br>
            <p> ✓ 토스머니 결제건만 확인 가능합니다. 신용카드 결제건은 <a href="#salesCheckLinkUrl">신용카드 매출전표</a>로 확인해 주세요.
            <p> ✓ 거래명세서 확인을 위해서는 구매자의 '생년월일' 과 '휴대폰번호' 로 추가 인증이 필요합니다.
            <p> ✓ 결제대기(PAY_APPROVED) 혹은 결제취소(PAY_CANCEL) 등의 미완료 거래건은 확인이 불가합니다.
          </div>
        </div>
        -->
      </div>
    </div>

    <script type="text/javascript">
      $(function() {
        //			hljs.configure({
        //			  tabReplace: '  ',
        //			  classPrefix: ''
        //			})
        //			hljs.initHighlightingOnLoad();

        // language toggle
        var $languages = $('.languages .language');
        $languages.click(function(e) {
          e.preventDefault();
          var lang = $(this).data('lang');
          $languages.removeClass('selected');
          $(this).addClass('selected');

          $('pre code').hide();
          $('pre code.' + lang).css('display', 'block');
        });
      });
    </script>
    <script src="../js/prism.js"></script>
  </body>
</html>
